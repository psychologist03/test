<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Тест на одиночество</title>
<style>
body { font-family: Arial; max-width: 800px; margin: 15px auto; padding: 15px; background: #f8f9fa; border-radius: 10px; }
h2 { text-align:center; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
th { background: #e9ecef; }
button { margin-top: 15px; padding: 10px 20px; font-size: 1em; background:#007BFF; color:#fff; border:none; border-radius:6px; cursor:pointer; }
#result { margin-top: 20px; background:#e9ecef; padding: 12px; border-radius:6px; display:none; text-align:center; }
</style>
</head>
<body>

<h2>Тест на чувство одиночества</h2>
<div>
  ФИО: <input type="text" id="fio" required>
  &nbsp; Группа: <input type="text" id="group" required>
</div>

<form id="formTest">
  <table>
    <thead>
      <tr>
        <th>№</th>
        <th style="text-align:left">Утверждение</th>
        <th>Часто<br>(3)</th>
        <th>Иногда<br>(2)</th>
        <th>Редко<br>(1)</th>
        <th>Никогда<br>(0)</th>
      </tr>
    </thead>
    <tbody id="questions"></tbody>
  </table>

  <button type="button" onclick="calculateResult()">Отправить результат</button>
</form>

<div id="result"></div>

<script>
const GS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxG__xXUvYDAi9-00ke6dIsOyWPfyubSy9ddNxJvwtHl9NQpvcSdriVNvSvvE8rt7_0Nw/exec"; // вставьте ваш Web App

const items = [
  "Я несчастлив, занимаясь столькими вещами в одиночку",
  "Мне не с кем поговорить",
  "Для меня невыносимо быть таким одиноким",
  "Мне не хватает общения",
  "Я чувствую, будто никто не понимает меня",
  "Я застаю себя в ожидании, что люди позвонят, напишут мне",
  "Нет никого, к кому бы я мог обратиться",
  "Я сейчас больше ни с кем не близок",
  "Те, кто меня окружает, не разделяют мои интересы",
  "Я чувствую себя покинутым",
  "Мне трудно раскрепощаться и общаться с окружающими",
  "Я чувствую себя совершенно одиноким",
  "Мои социальные отношения поверхностны",
  "Я умираю от тоски по компании",
  "Никто по-настоящему не знает меня",
  "Я чувствую себя изолированным",
  "Я несчастен, будучи таким отверженным",
  "Мне трудно заводить друзей",
  "Я чувствую себя исключенным",
  "Люди вокруг меня, но не со мной"
];

const tbody = document.getElementById("questions");

items.forEach((txt, i) => {
  const n = i + 1;
  tbody.innerHTML += `
    <tr>
      <td>${n}</td>
      <td style="text-align:left">${txt}</td>
      <td><input type="radio" name="q${n}" value="3" required></td>
      <td><input type="radio" name="q${n}" value="2"></td>
      <td><input type="radio" name="q${n}" value="1"></td>
      <td><input type="radio" name="q${n}" value="0"></td>
    </tr>`;
});

function interpret(score) {
  if(score >= 40) return "Высокий уровень одиночества";
  if(score >= 20) return "Средний уровень одиночества";
  return "Низкий уровень одиночества";
}

async function calculateResult() {
  const fio = document.getElementById("fio").value.trim();
  const group = document.getElementById("group").value.trim();

  let total = 0;
  let answers = [];

  for(let i=1; i<=items.length; i++){
    const radios = document.getElementsByName("q"+i);
    let val = null;
    for(const r of radios) if(r.checked) val = Number(r.value);
    if(val===null){ alert("Ответьте на вопрос №" + i); return; }
    total += val;
    answers.push(val);
  }

  const textInterpret = interpret(total);

  document.getElementById("result").style.display = "block";
  document.getElementById("result").innerHTML = `
    <h3>Результат</h3>
    <b>ФИО:</b> ${fio}<br>
    <b>Группа:</b> ${group}<br>
    <b>Баллы:</b> ${total} / 60<br>
    <b>Интерпретация:</b> ${textInterpret}
  `;

  // Отправка данных в Google Sheets
  try {
    await fetch(GS_SCRIPT_URL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ fio, group, totalScore: total, answers })
    });
  } catch(err) { console.log("Ошибка отправки:", err); }
}
</script>
</body>
</html>
