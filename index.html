<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Тест на одиночество</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; }
.question { margin-bottom: 15px; }
</style>
</head>
<body>

<h2>Тест на одиночество</h2>

<label>ФИО: <input id="fio" type="text"></label><br><br>
<label>Группа: <input id="group" type="text"></label><br><br>

<div id="questions"></div>

<button onclick="calculate()">Отправить</button>

<h3>Результат:</h3>
<div id="result"></div>

<script>
// ------------------ ВОПРОСЫ ------------------
const questions = [
    "Я чувствую себя одиноко.",
    "Мне кажется, что никому нет до меня дела.",
    "Мне не хватает общения.",
    "Меня редко понимают."
];

const answersHTML = questions.map((q, i) => `
  <div class="question">
      <b>${i+1}. ${q}</b><br>
      <label><input type="radio" name="q${i}" value="0"> Никогда</label>
      <label><input type="radio" name="q${i}" value="1"> Иногда</label>
      <label><input type="radio" name="q${i}" value="2"> Часто</label>
      <label><input type="radio" name="q${i}" value="3"> Всегда</label>
  </div>
`).join("");

document.getElementById("questions").innerHTML = answersHTML;

// ------------------ ИНТЕРПРЕТАЦИЯ ------------------
function getInterpretation(total) {
    if (total >= 40) return "Высокая степень одиночества";
    if (total >= 20) return "Средний уровень одиночества";
    return "Низкий уровень одиночества";
}

// ------------------ ПОДСЧЁТ ------------------
function calculate() {
    const fio = document.getElementById("fio").value.trim();
    const group = document.getElementById("group").value.trim();

    let total = 0;
    let answers = [];

    for (let i = 0; i < questions.length; i++) {
        const el = document.querySelector(`input[name="q${i}"]:checked`);
        const value = el ? Number(el.value) : 0;
        answers.push(value);
        total += value;
    }

    const percent = Math.round((total / (questions.length * 3)) * 100);
    const interpretation = getInterpretation(total);

    // ПОКАЗ НА ЭКРАНЕ
    document.getElementById("result").innerHTML =
        `<b>ФИО:</b> ${fio}<br>
         <b>Группа:</b> ${group}<br>
         <b>Баллы:</b> ${total} / ${questions.length * 3}<br>
         <b>Процент:</b> ${percent}%<br>
         <b>Интерпретация:</b> ${interpretation}<br>`;

    // ----------- ДАННЫЕ, КОТОРЫЕ УЙДУТ В APPS SCRIPT -------------
    const data = {
        fio: String(fio),
        group: String(group),
        totalScore: Number(total),
        percent: Number(percent),
        interpretation: String(interpretation),
        answers: JSON.stringify(answers)
    };

    // console.log("Отправка:", data);

    fetch("https://script.google.com/macros/s/AKfycbzGuDL1oTdjijwNyYPBCS3ED8ZgfgiN2HZTzoQuOVitwbNH653lEP2urnvQHOiHa_S-cg/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    })
    .then(() => console.log("Отправлено"))
    .catch(err => console.error("Ошибка:", err));
}
</script>

</body>
</html>

